<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thunder Kart Championship 2025</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Titillium Web', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #15151e;
            color: #ffffff;
            line-height: 1.6;
        }

        .header {
            background: linear-gradient(135deg, #e10600 0%, #ff1801 100%);
            padding: 20px 0;
            box-shadow: 0 2px 20px rgba(225, 6, 0, 0.3);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo {
            font-size: 2.5rem;
            font-weight: 900;
            color: #ffffff;
            text-transform: uppercase;
            letter-spacing: 3px;
        }

        .season-info {
            text-align: right;
            color: #ffffff;
            opacity: 0.9;
        }

        .season-info h2 {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .season-info p {
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .main-nav {
            background: #38383f;
            border-bottom: 1px solid #4a4a52;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: center;
        }

        .nav-tab {
            padding: 15px 30px;
            cursor: pointer;
            color: #ffffff;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .nav-tab:hover {
            background: #4a4a52;
            color: #e10600;
        }

        .nav-tab.active {
            background: #4a4a52;
            border-bottom-color: #e10600;
            color: #e10600;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
            animation: fadeIn 0.4s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-title {
            font-size: 2rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 30px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .standings-card {
            background: #38383f;
            border-radius: 8px;
            margin-bottom: 30px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .card-header {
            background: #2d2d34;
            padding: 20px;
            border-left: 4px solid #e10600;
        }

        .card-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #ffffff;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .f1-table {
            width: 100%;
            border-collapse: collapse;
            background: #38383f;
        }

        .f1-table thead {
            background: #2d2d34;
        }

        .f1-table th {
            padding: 15px 12px;
            text-align: left;
            font-weight: 600;
            color: #a1a1aa;
            text-transform: uppercase;
            font-size: 0.8rem;
            letter-spacing: 0.5px;
            border-bottom: 1px solid #4a4a52;
        }

        .f1-table td {
            padding: 18px 12px;
            border-bottom: 1px solid #4a4a52;
            color: #ffffff;
        }

        .f1-table tbody tr {
            transition: background-color 0.2s ease;
        }

        .f1-table tbody tr:hover {
            background: #4a4a52;
        }

        .position-cell {
            font-weight: 700;
            font-size: 1.1rem;
            width: 50px;
            text-align: center;
        }

        .driver-cell {
            font-weight: 600;
            font-size: 1rem;
        }

        .points-cell {
            font-weight: 700;
            color: #e10600;
            font-size: 1rem;
        }

        .time-cell {
            font-family: 'Monaco', 'Menlo', monospace;
            font-weight: 600;
            color: #a1a1aa;
        }

        .fastest-time {
            color: #9333ea !important;
            font-weight: 700;
        }

        .gap-cell {
            color: #a1a1aa;
            font-family: 'Monaco', 'Menlo', monospace;
        }

        /* Podium positions */
        .pos-1 { background: linear-gradient(90deg, #ffd700, #ffed4e); color: #000 !important; }
        .pos-2 { background: linear-gradient(90deg, #c0c0c0, #e5e5e5); color: #000 !important; }
        .pos-3 { background: linear-gradient(90deg, #cd7f32, #daa520); color: #fff !important; }

        .pos-1 td, .pos-2 td, .pos-3 td {
            color: inherit;
        }

        .circuit-nav {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .circuit-btn {
            padding: 12px 20px;
            background: #38383f;
            border: 1px solid #4a4a52;
            border-radius: 6px;
            color: #ffffff;
            cursor: pointer;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
        }

        .circuit-btn:hover {
            background: #4a4a52;
            border-color: #e10600;
        }

        .circuit-btn.active {
            background: #e10600;
            border-color: #e10600;
            color: #ffffff;
        }

        .results-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .circuit-info {
            background: #2d2d34;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #e10600;
        }

        .circuit-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 10px;
        }

        .circuit-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            color: #a1a1aa;
        }

        .circuit-stat {
            text-align: center;
        }

        .stat-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: #e10600;
            display: block;
        }

        .stat-label {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .session-tabs {
            display: flex;
            margin-bottom: 20px;
            background: #2d2d34;
            border-radius: 6px;
            padding: 4px;
        }

        .session-tab {
            flex: 1;
            padding: 10px;
            text-align: center;
            background: transparent;
            border: none;
            color: #a1a1aa;
            font-weight: 600;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.2s ease;
            text-transform: uppercase;
            font-size: 0.85rem;
        }

        .session-tab.active {
            background: #e10600;
            color: #ffffff;
        }

        .session-content {
            display: none;
        }

        .session-content.active {
            display: block;
        }

        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: #38383f;
            padding: 25px;
            border-radius: 8px;
            text-align: center;
            border-left: 4px solid #e10600;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 900;
            color: #e10600;
            margin-bottom: 10px;
        }

        .stat-title {
            color: #a1a1aa;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 1px;
            font-weight: 600;
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }

            .logo {
                font-size: 2rem;
            }

            .nav-container {
                flex-wrap: wrap;
            }

            .nav-tab {
                padding: 12px 20px;
                font-size: 0.8rem;
            }

            .results-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .f1-table th,
            .f1-table td {
                padding: 10px 8px;
                font-size: 0.85rem;
            }

            .circuit-details {
                grid-template-columns: 1fr 1fr;
            }

            .section-title {
                font-size: 1.5rem;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 20px 10px;
            }

            .f1-table th,
            .f1-table td {
                padding: 8px 6px;
                font-size: 0.8rem;
            }

            .stats-overview {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">Thunder Kart</div>
            <div class="season-info">
                <h2>2025 Championship</h2>
                <p>Elite Racing Series</p>
            </div>
        </div>
    </header>

    <nav class="main-nav">
        <div class="nav-container">
            <div class="nav-tab active" onclick="showSection('standings')">Standings</div>
            <div class="nav-tab" onclick="showSection('results')">Results</div>
            <div class="nav-tab" onclick="showSection('statistics')">Statistics</div>
        </div>
    </nav>

    <div class="container">
        <!-- Championship Standings -->
        <div id="standings" class="content-section active">
            <h1 class="section-title">Championship Standings</h1>
            
            <div class="standings-card">
                <div class="card-header">
                    <h2 class="card-title">Drivers' Championship</h2>
                </div>
                <table class="f1-table">
                    <thead>
                        <tr>
                            <th>Pos</th>
                            <th>Driver</th>
                            <th>PTS</th>
                            <th>Wins</th>
                            <th>Podiums</th>
                            <th>Best Finish</th>
                        </tr>
                    </thead>
                    <tbody id="championship-table">
                        <tr class="pos-1">
                            <td class="position-cell">1</td>
                            <td class="driver-cell">Alex Rodriguez</td>
                            <td class="points-cell">156</td>
                            <td>4</td>
                            <td>6</td>
                            <td>1st</td>
                        </tr>
                        <tr class="pos-2">
                            <td class="position-cell">2</td>
                            <td class="driver-cell">Maria Santos</td>
                            <td class="points-cell">142</td>
                            <td>3</td>
                            <td>5</td>
                            <td>1st</td>
                        </tr>
                        <tr class="pos-3">
                            <td class="position-cell">3</td>
                            <td class="driver-cell">Jake Thompson</td>
                            <td class="points-cell">128</td>
                            <td>2</td>
                            <td>4</td>
                            <td>1st</td>
                        </tr>
                        <tr>
                            <td class="position-cell">4</td>
                            <td class="driver-cell">Sofia Chen</td>
                            <td class="points-cell">114</td>
                            <td>1</td>
                            <td>3</td>
                            <td>1st</td>
                        </tr>
                        <tr>
                            <td class="position-cell">5</td>
                            <td class="driver-cell">Lucas Miller</td>
                            <td class="points-cell">98</td>
                            <td>1</td>
                            <td>2</td>
                            <td>1st</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Results Section -->
        <div id="results" class="content-section">
            <h1 class="section-title">Race Results</h1>
            
            <div class="circuit-nav">
                <div class="circuit-btn active" onclick="showCircuit('silverstone')">Silverstone GP</div>
                <div class="circuit-btn" onclick="showCircuit('monaco')">Monaco Street</div>
                <div class="circuit-btn" onclick="showCircuit('spa')">Spa-Francorchamps</div>
                <div class="circuit-btn" onclick="showCircuit('monza')">Monza Speed</div>
            </div>

            <!-- Silverstone Results -->
            <div id="silverstone" class="circuit-results active-circuit">
                <div class="circuit-info">
                    <div class="circuit-name">Silverstone Grand Prix</div>
                    <div class="circuit-details">
                        <div class="circuit-stat">
                            <span class="stat-value" id="silverstone-laps">20</span>
                            <span class="stat-label">Laps</span>
                        </div>
                        <div class="circuit-stat">
                            <span class="stat-value">1.850</span>
                            <span class="stat-label">Circuit Length (km)</span>
                        </div>
                        <div class="circuit-stat">
                            <span class="stat-value">37.0</span>
                            <span class="stat-label">Race Distance (km)</span>
                        </div>
                    </div>
                </div>

                <div class="session-tabs">
                    <button class="session-tab active" onclick="showSession('silverstone', 'practice')">Practice</button>
                    <button class="session-tab" onclick="showSession('silverstone', 'qualifying')">Qualifying</button>
                    <button class="session-tab" onclick="showSession('silverstone', 'race')">Race</button>
                </div>

                <div id="silverstone-practice" class="session-content active">
                    <div class="standings-card">
                        <div class="card-header">
                            <h2 class="card-title">Practice Session</h2>
                        </div>
                        <table class="f1-table">
                            <thead>
                                <tr>
                                    <th>Pos</th>
                                    <th>Driver</th>
                                    <th>Time</th>
                                    <th>Gap</th>
                                    <th>Laps</th>
                                </tr>
                            </thead>
                            <tbody id="silverstone-practice-table">
                                <tr>
                                    <td class="position-cell">1</td>
                                    <td class="driver-cell">Alex Rodriguez</td>
                                    <td class="time-cell fastest-time">1:24.156</td>
                                    <td class="gap-cell">-</td>
                                    <td>12</td>
                                </tr>
                                <tr>
                                    <td class="position-cell">2</td>
                                    <td class="driver-cell">Maria Santos</td>
                                    <td class="time-cell">1:24.389</td>
                                    <td class="gap-cell">+0.233</td>
                                    <td>15</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div id="silverstone-qualifying" class="session-content">
                    <div class="standings-card">
                        <div class="card-header">
                            <h2 class="card-title">Qualifying Results</h2>
                        </div>
                        <table class="f1-table">
                            <thead>
                                <tr>
                                    <th>Pos</th>
                                    <th>Driver</th>
                                    <th>Best Lap</th>
                                    <th>Fast Lap</th>
                                    <th>Gap</th>
                                    <th>Laps</th>
                                </tr>
                            </thead>
                            <tbody id="silverstone-qualifying-table">
                                <tr>
                                    <td class="position-cell">1</td>
                                    <td class="driver-cell">Oscaristo</td>
                                    <td class="time-cell fastest-time">00:47.213</td>
                                    <td>9</td>
                                    <td class="gap-cell">-</td>
                                    <td>9</td>
                                </tr>
                                <tr>
                                    <td class="position-cell">2</td>
                                    <td class="driver-cell">o11ve</td>
                                    <td class="time-cell">00:47.429</td>
                                    <td>8</td>
                                    <td class="gap-cell">+0.216</td>
                                    <td>8</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div id="silverstone-race" class="session-content">
                    <div class="standings-card">
                        <div class="card-header">
                            <h2 class="card-title">Race Results</h2>
                        </div>
                        <table class="f1-table">
                            <thead>
                                <tr>
                                    <th>Pos</th>
                                    <th>Driver</th>
                                    <th>Best Lap</th>
                                    <th>Fast Lap</th>
                                    <th>Gap</th>
                                    <th>Laps</th>
                                    <th>PTS</th>
                                </tr>
                            </thead>
                            <tbody id="silverstone-race-table">
                                <tr class="pos-1">
                                    <td class="position-cell">1</td>
                                    <td class="driver-cell">Oscaristo</td>
                                    <td class="time-cell">00:47.204</td>
                                    <td>13</td>
                                    <td class="gap-cell">-</td>
                                    <td>16</td>
                                    <td class="points-cell">25</td>
                                </tr>
                                <tr class="pos-2">
                                    <td class="position-cell">2</td>
                                    <td class="driver-cell">Crosshairs4G63</td>
                                    <td class="time-cell fastest-time">00:47.105</td>
                                    <td>9</td>
                                    <td class="gap-cell">+0.684</td>
                                    <td>16</td>
                                    <td class="points-cell">18</td>
                                </tr>
                                <tr class="pos-3">
                                    <td class="position-cell">3</td>
                                    <td class="driver-cell">o11ve</td>
                                    <td class="time-cell">00:47.492</td>
                                    <td>10</td>
                                    <td class="gap-cell">+9.784</td>
                                    <td>16</td>
                                    <td class="points-cell">15</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Other circuits would follow the same pattern -->
            <div id="monaco" class="circuit-results">
                <div class="circuit-info">
                    <div class="circuit-name">Monaco Street Circuit</div>
                    <div class="circuit-details">
                        <div class="circuit-stat">
                            <span class="stat-value" id="monaco-laps">25</span>
                            <span class="stat-label">Laps</span>
                        </div>
                        <div class="circuit-stat">
                            <span class="stat-value">1.420</span>
                            <span class="stat-label">Circuit Length (km)</span>
                        </div>
                        <div class="circuit-stat">
                            <span class="stat-value">35.5</span>
                            <span class="stat-label">Race Distance (km)</span>
                        </div>
                    </div>
                </div>
                <!-- Monaco sessions would go here -->
            </div>

            <div id="spa" class="circuit-results">
                <div class="circuit-info">
                    <div class="circuit-name">Spa-Francorchamps</div>
                    <div class="circuit-details">
                        <div class="circuit-stat">
                            <span class="stat-value" id="spa-laps">15</span>
                            <span class="stat-label">Laps</span>
                        </div>
                        <div class="circuit-stat">
                            <span class="stat-value">2.480</span>
                            <span class="stat-label">Circuit Length (km)</span>
                        </div>
                        <div class="circuit-stat">
                            <span class="stat-value">37.2</span>
                            <span class="stat-label">Race Distance (km)</span>
                        </div>
                    </div>
                </div>
                <!-- Spa sessions would go here -->
            </div>

            <div id="monza" class="circuit-results">
                <div class="circuit-info">
                    <div class="circuit-name">Monza Speed Circuit</div>
                    <div class="circuit-details">
                        <div class="circuit-stat">
                            <span class="stat-value" id="monza-laps">18</span>
                            <span class="stat-label">Laps</span>
                        </div>
                        <div class="circuit-stat">
                            <span class="stat-value">2.050</span>
                            <span class="stat-label">Circuit Length (km)</span>
                        </div>
                        <div class="circuit-stat">
                            <span class="stat-value">36.9</span>
                            <span class="stat-label">Race Distance (km)</span>
                        </div>
                    </div>
                </div>
                <!-- Monza sessions would go here -->
            </div>
        </div>

        <!-- Statistics Section -->
        <div id="statistics" class="content-section">
            <h1 class="section-title">Statistics</h1>
            
            <div class="stats-overview">
                <div class="stat-card">
                    <div class="stat-number">8</div>
                    <div class="stat-title">Races Completed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">4</div>
                    <div class="stat-title">Circuits</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">1:17.234</div>
                    <div class="stat-title">Fastest Lap</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">5</div>
                    <div class="stat-title">Different Winners</div>
                </div>
            </div>

            <div class="standings-card">
                <div class="card-header">
                    <h2 class="card-title">Fastest Laps by Circuit</h2>
                </div>
                <table class="f1-table">
                    <thead>
                        <tr>
                            <th>Circuit</th>
                            <th>Driver</th>
                            <th>Time</th>
                            <th>Session</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Monaco Street</td>
                            <td class="driver-cell">Maria Santos</td>
                            <td class="time-cell fastest-time">1:17.234</td>
                            <td>Qualifying</td>
                        </tr>
                        <tr>
                            <td>Silverstone GP</td>
                            <td class="driver-cell">Alex Rodriguez</td>
                            <td class="time-cell fastest-time">1:23.234</td>
                            <td>Qualifying</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- PapaParse CSV Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    
    <script>
        // Global data storage
        let circuitData = {};
        let championshipData = [];

        // Navigation functionality
        function showSection(sectionId) {
            // Hide all sections
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => section.classList.remove('active'));
            
            // Remove active class from all nav tabs
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Show selected section and activate tab
            document.getElementById(sectionId).classList.add('active');
            event.target.classList.add('active');
        }

        // Circuit switching functionality
        function showCircuit(circuitId) {
            // Hide all circuit results
            const circuits = document.querySelectorAll('.circuit-results');
            circuits.forEach(circuit => circuit.classList.remove('active-circuit'));
            
            // Remove active class from all circuit buttons
            const buttons = document.querySelectorAll('.circuit-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            // Show selected circuit and activate button
            document.getElementById(circuitId).classList.add('active-circuit');
            event.target.classList.add('active');
        }

        // Session switching functionality
        function showSession(circuitId, sessionType) {
            // Hide all session contents for this circuit
            const sessions = document.querySelectorAll(`#${circuitId} .session-content`);
            sessions.forEach(session => session.classList.remove('active'));
            
            // Remove active class from all session tabs for this circuit
            const tabs = document.querySelectorAll(`#${circuitId} .session-tab`);
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Show selected session and activate tab
            document.getElementById(`${circuitId}-${sessionType}`).classList.add('active');
            event.target.classList.add('active');
        }

        // Load CSV data
        async function loadCSVData() {
            try {
                const circuits = [
                    { id: 'silverstone', name: 'Silverstone GP' },
                    { id: 'monaco', name: 'Monaco Street' },
                    { id: 'spa', name: 'Spa-Francorchamps' },
                    { id: 'monza', name: 'Monza Speed' }
                ];

                // Load data for each circuit
                for (const circuit of circuits) {
                    try {
                        circuitData[circuit.id] = { name: circuit.name };

                        // Load practice data (optional)
                        try {
                            const practiceResponse = await fetch(`data/${circuit.id}_practice.csv`);
                            if (practiceResponse.ok) {
                                const practiceCsv = await practiceResponse.text();
                                const practiceData = Papa.parse(practiceCsv, {
                                    header: true,
                                    skipEmptyLines: true,
                                    dynamicTyping: false
                                });
                                circuitData[circuit.id].practice = practiceData.data;
                            }
                        } catch (e) {
                            console.log(`No practice data for ${circuit.name}`);
                        }

                        // Load qualifying data
                        const qualifyingResponse = await fetch(`data/${circuit.id}_qualifying.csv`);
                        if (qualifyingResponse.ok) {
                            const qualifyingCsv = await qualifyingResponse.text();
                            const qualifyingData = Papa.parse(qualifyingCsv, {
                                header: true,
                                skipEmptyLines: true,
                                dynamicTyping: false,
                                delimiter: ';',  // Handle semicolon-separated files
                                transformHeader: header => header.trim() // Remove extra spaces
                            });
                            circuitData[circuit.id].qualifying = qualifyingData.data;
                        }

                        // Load race data
                        const raceResponse = await fetch(`data/${circuit.id}_race.csv`);
                        if (raceResponse.ok) {
                            const raceCsv = await raceResponse.text();
                            const raceData = Papa.parse(raceCsv, {
                                header: true,
                                skipEmptyLines: true,
                                dynamicTyping: false,
                                delimiter: ';',  // Handle semicolon-separated files
                                transformHeader: header => header.trim() // Remove extra spaces
                            });
                            circuitData[circuit.id].race = raceData.data;
                        }

                        // Load circuit info (laps, length, etc.)
                        try {
                            const circuitInfoResponse = await fetch(`data/${circuit.id}_info.csv`);
                            if (circuitInfoResponse.ok) {
                                const circuitInfoCsv = await circuitInfoResponse.text();
                                const circuitInfoData = Papa.parse(circuitInfoCsv, {
                                    header: true,
                                    skipEmptyLines: true,
                                    dynamicTyping: false
                                });
                                if (circuitInfoData.data.length > 0) {
                                    circuitData[circuit.id].info = circuitInfoData.data[0];
                                    updateCircuitInfo(circuit.id);
                                }
                            }
                        } catch (e) {
                            console.log(`No circuit info for ${circuit.name}`);
                        }

                        // Update the circuit displays
                        updateCircuitDisplay(circuit.id);

                    } catch (error) {
                        console.log(`Error loading data for ${circuit.name}:`, error);
                    }
                }

                // Load championship data
                try {
                    const championshipResponse = await fetch('data/championship.csv');
                    if (championshipResponse.ok) {
                        const championshipCsv = await championshipResponse.text();
                        const championshipParsed = Papa.parse(championshipCsv, {
                            header: true,
                            skipEmptyLines: true,
                            dynamicTyping: false
                        });
                        
                        championshipData = championshipParsed.data;
                        updateChampionshipDisplay();
                    }
                } catch (error) {
                    console.log('No championship CSV found, using default data');
                }

                // Load constructors data - REMOVED since no teams

            } catch (error) {
                console.error('Error loading CSV data:', error);
            }
        }

        // Update circuit info display
        function updateCircuitInfo(circuitId) {
            const data = circuitData[circuitId];
            if (!data || !data.info) return;

            const info = data.info;
            
            // Update laps
            const lapsElement = document.getElementById(`${circuitId}-laps`);
            if (lapsElement && info.Laps) {
                lapsElement.textContent = info.Laps;
            }

            // Update other circuit info if elements exist
            const circuitDiv = document.getElementById(circuitId);
            if (circuitDiv) {
                const statValues = circuitDiv.querySelectorAll('.stat-value');
                if (statValues.length >= 3) {
                    if (info.Length) statValues[1].textContent = info.Length;
                    if (info.RaceDistance) statValues[2].textContent = info.RaceDistance;
                }
            }
        }

        // Update circuit display with CSV data
        function updateCircuitDisplay(circuitId) {
            const data = circuitData[circuitId];
            if (!data) return;

            // Update practice session
            if (data.practice) {
                updateSessionTable(`${circuitId}-practice-table`, data.practice, 'practice');
            }

            // Update qualifying session
            if (data.qualifying) {
                updateSessionTable(`${circuitId}-qualifying-table`, data.qualifying, 'qualifying');
            }

            // Update race session
            if (data.race) {
                updateSessionTable(`${circuitId}-race-table`, data.race, 'race');
            }
        }

        // Update session table with data
        function updateSessionTable(tableId, data, sessionType) {
            const table = document.getElementById(tableId);
            if (!table || !data || data.length === 0) return;

            table.innerHTML = '';
            
            // Find fastest lap time for highlighting
            let fastestTime = null;
            if (sessionType === 'race' || sessionType === 'qualifying') {
                const times = data.filter(r => r['Best Lap'] && r['Best Lap'].trim() !== '').map(r => r['Best Lap'].trim());
                if (times.length > 0) {
                    fastestTime = times.sort()[0];
                }
            }
            
            data.forEach((row, index) => {
                // Clean up the data
                const cleanRow = {};
                Object.keys(row).forEach(key => {
                    const cleanKey = key.trim();
                    const cleanValue = typeof row[key] === 'string' ? row[key].trim() : row[key];
                    cleanRow[cleanKey] = cleanValue;
                });

                const tr = document.createElement('tr');
                const position = parseInt(cleanRow.Position) || index + 1;
                
                // Add podium classes for race results
                if (sessionType === 'race') {
                    if (position === 1) tr.classList.add('pos-1');
                    else if (position === 2) tr.classList.add('pos-2');
                    else if (position === 3) tr.classList.add('pos-3');
                }

                const bestLap = cleanRow['Best Lap'] || '-';
                const isFastest = bestLap === fastestTime;

                // Build table row based on session type
                if (sessionType === 'qualifying') {
                    tr.innerHTML = `
                        <td class="position-cell">${position}</td>
                        <td class="driver-cell">${cleanRow.Driver || ''}</td>
                        <td class="time-cell ${isFastest ? 'fastest-time' : ''}">${bestLap}</td>
                        <td>${cleanRow['Fast Lap'] || '-'}</td>
                        <td class="gap-cell">${cleanRow.Gap || (position === 1 ? '-' : '')}</td>
                        <td>${cleanRow.Laps || '-'}</td>
                    `;
                } else if (sessionType === 'race') {
                    tr.innerHTML = `
                        <td class="position-cell">${position}</td>
                        <td class="driver-cell">${cleanRow.Driver || ''}</td>
                        <td class="time-cell ${isFastest ? 'fastest-time' : ''}">${bestLap}</td>
                        <td>${cleanRow['Fast Lap'] || '-'}</td>
                        <td class="gap-cell">${cleanRow.Gap || (position === 1 ? '-' : '')}</td>
                        <td>${cleanRow.Laps || '-'}</td>
                        <td class="points-cell">${cleanRow.Points || 0}</td>
                    `;
                } else if (sessionType === 'practice') {
                    tr.innerHTML = `
                        <td class="position-cell">${position}</td>
                        <td class="driver-cell">${cleanRow.Driver || ''}</td>
                        <td class="time-cell ${isFastest ? 'fastest-time' : ''}">${bestLap}</td>
                        <td class="gap-cell">${cleanRow.Gap || (position === 1 ? '-' : '')}</td>
                        <td>${cleanRow.Laps || '-'}</td>
                    `;
                }
                
                table.appendChild(tr);
            });
        }

        // Update championship display with CSV data
        function updateChampionshipDisplay() {
            if (championshipData.length === 0) return;

            const championshipTable = document.getElementById('championship-table');
            if (!championshipTable) return;

            championshipTable.innerHTML = '';
            championshipData.forEach((row, index) => {
                const tr = document.createElement('tr');
                const position = parseInt(row.Position) || index + 1;
                
                // Add podium classes
                if (position === 1) tr.classList.add('pos-1');
                else if (position === 2) tr.classList.add('pos-2');
                else if (position === 3) tr.classList.add('pos-3');
                
                tr.innerHTML = `
                    <td class="position-cell">${position}</td>
                    <td class="driver-cell">${row.Driver || ''}</td>
                    <td class="points-cell">${row.Points || 0}</td>
                    <td>${row.Wins || 0}</td>
                    <td>${row.Podiums || 0}</td>
                    <td>${row.BestFinish || '-'}</td>
                `;
                championshipTable.appendChild(tr);
            });
        }

        // Update constructors display - REMOVED since no teams

        // Initialize everything
        document.addEventListener('DOMContentLoaded', async function() {
            // Show default circuit
            document.getElementById('silverstone').style.display = 'block';
            
            // Load CSV data
            await loadCSVData();
            
            console.log('Kart Championship website loaded successfully');
        });

        // Manual data refresh function
        function refreshData() {
            loadCSVData().then(() => {
                console.log('Data refreshed successfully');
            });
        }
    </script>

    <style>
        .circuit-results {
            display: none;
        }
        
        .circuit-results.active-circuit {
            display: block;
        }
    </style>
</body>
</html>